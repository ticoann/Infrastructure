# vim: set ft=sh sw=2 ts=8 et :
deploy_phedex_web_deps()
{
  deploy Backend
}

deploy_phedex_web_prep()
{
  mkproj phedex-web logs sessions
  setgroup ug+rw,o-w _phedex $PWD/{logs,sessions}
}

deploy_phedex_web_sw()
{
  deploy_pkg -d phedex-web -l srv -c PhEDEx/web comp cms+PHEDEX-web WEB_3_1_7post1
  perl -p -i -e "s{/where/i/put/my}{$root/projects/conf/phedex}g" \
    srv/Documentation/WebConfig/phedexweb-app.conf \
    srv/bin/cmsweb_phedex_graphs

  rm -f apache2
  ln -s $root/$(echo comp | sed -e "$repoedit")sw/apache2 apache2
  setgroup g+w _config apache2/{logs,var} # hack, need to write here too
  rm -f apache2/logs/start_stop.log
}

deploy_phedex_web_post()
{
  cd $root/projects/phedex-web
  (crontab -l | { fgrep -v "$PWD/" || true; }
   sysboot _phedex 'rgraphs "I did read documentation"') | crontab -
}
